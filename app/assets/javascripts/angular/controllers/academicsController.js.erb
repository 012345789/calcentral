<% if Settings.features.bearfacts %>
(function(calcentral) {
  'use strict';

  /**
   * Academics controller
   */
  calcentral.controller('AcademicsController', ['apiService', '$http', '$routeParams', '$scope', function(apiService, $http, $routeParams, $scope) {

    apiService.util.setTitle('My Academics');


    $scope.getUserStatus = function() {
      // return $http.get('/dummy/json/status_oski_sample.json').success(function(data) {
      return $http.get('/api/my/status').success(function(data) {
        $scope.user_status = data;
      });
    };
    $scope.getUserStatus();

    $scope.getAcademics = function() {
      // return $http.get('/dummy/json/academics.json').success(function(data) {
      return $http.get('/api/my/academics').success(function(data) {
        $scope.academics = data;
        $scope.exam_schedule = data.exam_schedule;
        $scope.semesters = data.semesters;

        // Get selected semester from URL params and extract from semesters array
        angular.forEach(data.semesters, function(semester) {
          if (semester.slug === $routeParams.semester_slug) {
            $scope.selected_semester = semester;
          }
        });

      });
    };
    $scope.getAcademics();

    $scope.toggleBlockHistory = function() {
      $scope.show_block_history = !$scope.show_block_history;
      apiService.analytics.trackEvent(['Block history', 'Show history panel - ' + $scope.show_block_history ? 'Show' : 'Hide']);
    };

  }]);

})(window.calcentral);
<% end %>
