<script type="text/ng-template" id="templates/dashboard.html">

  <div class="five columns push-three cc-page-dashboard-column-b">
    <!-- Begin Tasks / Assignments column -->

    <div class="cc-container-widget" id="cc-widget-tasks" data-ng-controller="TasksController">
      <div class="cc-widget-title">
        <h2 class="cc-left">Assignments and Tasks</h2>
        <button
            class="cc-widget-add-icon cc-left"
            title="Add a task"
            data-ng-click="toggleAddTask()">
          <div class="cc-widget-add-icon-plus">+</div>
          <div class="cc-widget-add-icon-text" aria-labelledby="addTaskLabel">Task</div>
          <div id="addTaskLabel" class="visuallyhidden">Add a task</div>
        </button>
      </div>
      <div class="cc-tasks-list">
        <div class="cc-widget-body">
          <form class="cc-widget-tasks-form" name="cc_widget_tasks_form" data-ng-show="show_add_task" data-ng-submit="addTask()" novalidate>
            <div class="row">
              <div class="two columns mobile-one">
                <label for="cc-widget-tasks-addtask-title"><strong>Task</strong>:</label>
              </div>
              <div class="ten columns mobile-three">
                <input data-ng-model="add_task.title" id="cc-widget-tasks-addtask-title" type="text" required aria-required="true" />
              </div>
            </div>
            <div class="row">
              <div class="two columns mobile-one">
                <label for="cc-widget-tasks-addtask-date">Due:</label>
              </div>
              <div class="ten columns mobile-three">
                <input type="text"
                  data-ng-model="add_task.due_date"
                  name="add_task_due_date"
                  id="cc-widget-tasks-addtask-date"
                  placeholder="mm/dd/yy"
                  data-cc-mmddyyvalidator
                />
                <p class="cc-alert-nobang" data-ng-show="cc_widget_tasks_form.add_task_due_date.$error.ccMmddyyvalidator">
                  Please use mm/dd/yy date format
                </p>
              </div>
            </div>
            <div class="row">
              <div class="two columns mobile-one">
                <label for="cc-widget-tasks-addtask-note">Note:</label>
              </div>
              <div class="ten columns mobile-three">
                <textarea data-ng-model="add_task.note" id="cc-widget-tasks-addtask-note" rows="2" /></textarea>
              </div>
            </div>
            <div class="row" data-ng-show="is_task_processing">
              <div class="ten columns offset-by-two mobile-three">
                Task is being added...
              </div>
            </div>
            <div class="row"  data-ng-show="!is_task_processing">
              <div class="ten columns offset-by-two mobile-three cc-widget-tasks-form-buttons">
                <button type="submit"
                  data-ng-disabled="cc_widget_tasks_form.$invalid || is_task_processing"
                  data-ng-class="{true:'cc-button-submit'}[cc_widget_tasks_form.$valid]">Add Task
                </button>
                <button class="cc-button-reset" type="reset" data-ng-click="toggleAddTask()" />Cancel</button>
              </div>
            </div>
          </form>

          <div class="row cc-widget-tasks-button-top-margin">
            <div class="ten columns centered">
              <ul class="button-group radius even three-up">
                <li>
                  <button class="tiny button"
                    data-ng-click="switchTasksMode('scheduled')"
                    data-ng-class="{'secondary':(tasks_mode!='scheduled'),'selected':(tasks_mode=='scheduled')}">Scheduled
                  </button>
                </li>
                <li>
                  <button class="tiny button"
                    data-ng-click="switchTasksMode('unscheduled')"
                    data-ng-class="{'secondary':(tasks_mode!='unscheduled'),'selected':(tasks_mode=='unscheduled')}">Unscheduled
                  </button>
                </li>
                <li>
                  <button class="tiny button"
                    data-ng-click="switchTasksMode('completed')"
                    data-ng-class="{'secondary':(tasks_mode!='completed'),'selected':(tasks_mode=='completed')}">Completed
                  </button>
                </li>
              </ul>
            </div>
          </div>

          <div data-ng-switch on="tasks_mode">
            <div data-ng-switch-when="scheduled">

              <div class="row">
                <h3 class="nine columns end cc-widget-section-label cc-widget-tasks-section-top">Overdue</h3>
                <div class="three columns cc-right cc-widget-section-label-due">Due</div>
              </div>
              <ul class="cc-widget-tasks-notifications-list">
                <li
                  data-ng-repeat="task in filtered = (tasks | filter:filterOverdue)"
                  data-ng-class="{'cc-widget-list-selected': task.show}">
                  <div data-ng-include src="'templates/dashboard_task_loop.html'"></div>
                </li>
              </ul>
              <p data-ng-show="!filtered.length" class="cc-widget-text">
                There are currently no {{tasks_mode}} tasks/assignments that are overdue.
              </p>

              <h3 class="cc-widget-section-label cc-widget-tasks-section-top">Due Today</h3>
              <ul class="cc-widget-tasks-notifications-list">
                <li
                  data-ng-repeat="task in filtered = (tasks | filter:filterDueToday)"
                  data-ng-class="{'cc-widget-list-selected': task.show}">
                  <div data-ng-include src="'templates/dashboard_task_loop.html'"></div>
                </li>
              </ul>
              <p data-ng-show="!filtered.length" class="cc-widget-text">
                There are currently no {{tasks_mode}} tasks/assignments that are due today.
              </p>

              <h3 class="cc-widget-section-label cc-widget-tasks-section-top">Due This Week</h3>
              <ul class="cc-widget-tasks-notifications-list">
                <li
                  data-ng-repeat="task in filtered = (tasks | filter:filterDueThisWeek)"
                  data-ng-class="{'cc-widget-list-selected': task.show}">
                  <div data-ng-include src="'templates/dashboard_task_loop.html'"></div>
                </li>
              </ul>
              <p data-ng-show="!filtered.length" class="cc-widget-text">
                There are currently no {{tasks_mode}} tasks/assignments that are due this week.
              </p>

              <h3 class="cc-widget-section-label cc-widget-tasks-section-top">Due Next Week</h3>
              <ul class="cc-widget-tasks-notifications-list">
                <li
                  data-ng-repeat="task in filtered = (tasks | filter:filterDueNextWeek)"
                  data-ng-class="{'cc-widget-list-selected': task.show}">
                  <div data-ng-include src="'templates/dashboard_task_loop.html'"></div>
                </li>
              </ul>
              <p data-ng-show="!filtered.length" class="cc-widget-text">
                There are currently no {{tasks_mode}} tasks/assignments that are due next week.
              </p>

            </div>


            <div data-ng-switch-when="unscheduled">
              <div class="row">
                <h3 class="nine columns end cc-widget-section-label cc-widget-tasks-section-top">Unscheduled</h3>
              </div>
              <ul class="cc-widget-tasks-notifications-list">
                <li
                  data-ng-repeat="task in filtered = (tasks | orderBy:'updated' | filter:filterUnScheduled)"
                  data-ng-class="{'cc-widget-list-selected': task.show}">
                  <div data-ng-include src="'templates/dashboard_task_loop.html'"></div>
                </li>
              </ul>
              <p data-ng-show="!filtered.length" class="cc-widget-text">
                There are currently no {{tasks_mode}} tasks/assignments that are unscheduled.
              </p>
            </div>

            <div data-ng-switch-when="completed">
              <div class="row">
                <div class="three columns end cc-right cc-widget-section-label-due">Completed</div>
              </div>

              <ul class="cc-widget-tasks-notifications-list">
                <li
                  data-ng-repeat="task in filtered = (tasks | orderBy:'completed_date.epoch':true | filter:{status:'completed'})"
                  data-ng-class="{'cc-widget-list-selected': task.show}">
                  <div data-ng-include src="'templates/dashboard_task_loop.html'"></div>
                </li>
              </ul>
              <p data-ng-show="!filtered.length" class="cc-widget-text">
                There are currently no completed tasks/assignments.
              </p>
            </div>

          </div>
        </div>
      </div>

    </div>
    <!-- End Tasks / Assignments column -->
  </div>


  <div class="four columns push-three cc-page-dashboard-column-c">
    <!-- Begin Notifications column -->

    <div class="cc-container-widget" id="cc-widget-notifications" data-ng-controller="NotificationsController">

      <div class="cc-widget-title">
        <h2>Notifications</h2>
      </div>

      <div class="cc-notifications-list">

        <ul class="cc-widget-tasks-notifications-list">
          <li data-ng-repeat="notification in notifications" data-ng-class="{'cc-widget-list-selected': notification.show}">
            <div class="row cc-widget-list-hover" data-ng-click="api.widget.toggleShow(notification, 'Notifications')">

              <div class="eight mobile-three columns cc-widget-notifications-text-column cc-widget-list-selected-title">
                <div class="cc-emitter-square cc-left cc-emitter-{{notification.color_class}}" title="{{notification.emitter}} notification"></div>
                <div class="cc-widget-notifications-text-margin cc-widget-list-hover-title">
                  {{notification.title}}<br />
                  <span class="cc-widget-notification-source">{{notification.source}}</span>
                </div>
              </div>

              <div class="three mobile-one columns end cc-right cc-widget-tasks-notifications-date-string">
                {{notification.date_string}}
              </div>
            </div>

            <div class="row cc-widget-tasks-notifications-more" data-ng-show="notification.show">
              <div class="cc-widget-tasks-notifications-text cc-widget-notifications-text-margin">
                <p>{{notification.summary}}</p>
              </div>
              <div class="cc-widget-tasks-notifications-text cc-widget-notifications-text-margin">
                <p><a
                  class="cc-widget-more-view-in"
                  data-ng-click="api.util.trackExternalLink('Notifications', notification.source, notification.source_url)"
                  data-ng-href="{{notification.source_url}}"
                >View in {{notification.source}}</a></p>
              </div>
            </div>
          </li>
        </ul>
      </div>
      <div data-ng-show="!notifications.length" class="cc-widget-text">
        You have no notifications at this time.
      </div>
    </div>

  <!-- End Notifications column -->
  </div>

  <div class="three columns pull-nine cc-page-dashboard-column-a">
    <!-- Begin Calendar / Classes / Groups column -->

    <div class="cc-container-widget" id="cc-widget-mycalendar" data-ng-controller="UpNextController">
      <div class="cc-widget-title">
        <h2>Up Next <a href="http://bcal.berkeley.edu" class="ir cc-right cc-icon cc-icon-calendar" title="View calendar in bCal">bCal</a></h2>
      </div>
      <div class="cc-widget-mycalendar-container">
        <ul class="cc-widget-mycalendar-datelist" data-ng-class="{'cc-widget-mycalendar-containsopen': api.widget.containsOpen(items)}">
          <!-- First loop: timestamped items -->
          <li data-ng-repeat="item in items" data-ng-class="{'cc-widget-list-selected': item.show}">
            <div class="cc-widget-list-hover" data-ng-click="api.widget.toggleShow(item, 'Up Next')">
              <div class="cc-widget-mycalendar-datelist-time cc-left">
                <div data-ng-switch on="item.is_all_day">
                  <div data-ng-switch-when="true" class="cc-widget-mycalendar-datelist-time-allday cc-left">all-day</div>
                  <div data-ng-switch-when="false">
                    <div class="cc-widget-mycalendar-datelist-time-hour cc-left">{{item.start.epoch * 1000 | date:'h'}}</div>
                    <div class="cc-widget-mycalendar-datelist-time-minutes cc-left">{{item.start.epoch * 1000 | date:'mm'}}<br>
                      <span class="cc-widget-mycalendar-datelist-time-ampm">{{item.start.epoch * 1000 | date:'a' | uppercase}}</span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="cc-widget-mycalendar-datelist-summary cc-ellipsis">
                <div class="cc-widget-list-selected-title cc-ellipsis">
                  {{item.summary}}
                </div>
                <div class="cc-ellipsis">
                  <a class="cc-widget-mycalendar-datelist-small" data-ng-href="{{item.location_url}}" data-ng-click="api.util.preventBubble($event);api.util.trackExternalLink('Up Next', 'Google maps', item.location_url)">{{item.location}}</a>
                </div>
              </div>
            </div>
            <div class="cc-widget-mycalendar-more" data-ng-show="item.show">
              <div class="cc-widget-mycalendar-startend row">
                <div data-ng-switch on="item.is_all_day">
                  <p data-ng-switch-when="true">
                    {{item.start.epoch * 1000 | date:'EEE, MMMM d'}}
                  </p>
                  <div data-ng-switch-when="false">
                    <div class="cc-widget-mycalendar-header three columns mobile-one">Start:</div>
                    <div class="nine columns mobile-three">{{item.start.epoch * 1000 | date:'short' | lowercase}}</div>

                    <div class="cc-widget-mycalendar-header three columns mobile-one">End:</div>
                    <div class="nine columns mobile-three">{{item.end.epoch * 1000 | date:'short' | lowercase}}</div>
                  </div>
              </div>
              <span class="cc-widget-mycalendar-header">Organizer:</span>
              <p class="cc-widget-mycalendar-indent">{{item.organizer.displayName}}</p>
              <span data-ng-show="item.attendees" class="cc-widget-mycalendar-header">Invitees:</span>
              <ul class="cc-widget-mycalendar-list-attendees cc-widget-mycalendar-indent">
                <li data-ng-repeat="attendee in item.attendees" class="cc-ellipsis">
                  {{attendee.displayName}}
                </li>
              </ul>
              <p class="cc-widget-mycalendar-indent cc-widget-mycalendar-datelist-small">
                <a href="{{item.html_link}}" data-ng-click="api.util.trackExternalLink('Up Next', 'bCal', item.html_link)">View in bCal</a>
              </p>
            </div>
          </li>
        </ul>
      </div>
      <div data-ng-show="!items.length" class="cc-widget-text">
        Today there are no events on your calendar.
      </div>
    </div>

    <div class="cc-container-widget" id="cc-widget-myclasses" data-ng-controller="MyClassesController">
      <div class="cc-widget-title">
        <h2>My Classes <span class="cc-right cc-widget-title-small"><%= Settings.sakai_proxy.current_terms.first %></span></h2>
      </div>
      <div class="cc-widget-mygroups-myclasses-list">
        <ul class="cc-widget-list">
          <li data-ng-repeat="class in myclasses" class="cc-widget-mygroups-myclasses-list-item">
            <div class="row">

              <div class="ten mobile-three columns">
                <div
                  class="cc-widget-list-icon cc-left cc-widget-mygroups-myclasses-icon"
                  data-ng-class="{true:'cc-icon-canvas',false:'cc-icon-bspace'}[class.emitter=='Canvas']">
                </div>
                <a
                  class="cc-ellipsis cc-myclasses-link-with-title"
                  data-ng-click="api.util.trackExternalLink('My Classes', class.emitter, class.site_url)"
                  data-ng-href="{{class.site_url}}"
                  >{{class.course_code}}
                </a>
                <a class="cc-ellipsis cc-widget-mygroups-myclasses-title-link"
                  data-ng-click="api.util.trackExternalLink('My Classes', class.emitter, class.site_url)"
                  data-ng-href="{{class.site_url}}"
                  >{{class.name}}
                </a>
              </div>

              <div class="two mobile-one columns cc-widget-mygroups-myclasses-emitter-column">
                <div class="cc-emitter-square cc-emitter-{{class.color_class}}" title="{{class.emitter}} class"></div>
              </div>

            </div>
          </li>
        </ul>
      </div>
      <div data-ng-show="!myclasses.length" class="cc-widget-text">
        There are currently no classes available.
      </div>
    </div>

    <div class="cc-container-widget" id="cc-widget-mygroups" data-ng-controller="MyGroupsController">
      <div class="cc-widget-title">
        <h2>My Groups</h2>
      </div>
      <div class="cc-widget-mygroups-myclasses-list">
        <ul class="cc-widget-list">
          <li data-ng-repeat="group in mygroups" class="cc-widget-mygroups-myclasses-list-item">
            <div class="row">

              <div class="ten mobile-three columns">
                <div
                  class="cc-widget-list-icon cc-left cc-widget-mygroups-myclasses-icon"
                  data-ng-class="{true:'cc-icon-canvas',false:'cc-icon-bspace'}[group.emitter=='Canvas']">
                </div>
                <a class="cc-ellipsis cc-widget-mygroups-myclasses-title-link"
                  data-ng-href="{{group.site_url}}"
                  data-ng-click="api.util.trackExternalLink('My Groups', group.emitter, group.site_url)">{{group.title}}
                </a>
              </div>

              <div class="two mobile-one columns cc-widget-mygroups-myclasses-emitter-column">
                <div class="cc-emitter-square cc-emitter-{{group.color_class}}" title="{{group.emitter}} group"></div>
              </div>

            </div>
          </li>
        </ul>
      </div>
      <div data-ng-show="!mygroups.length" class="cc-widget-text">
        There are currently no groups available.
      </div>
    </div>
    <!-- End Calendar / Classes / Groups column -->
  </div>

</script>
